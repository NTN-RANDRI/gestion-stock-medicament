<style>
  input.ng-touched.ng-invalid {
    outline: 2px solid var(--destructive);
  }
</style>

<div class="card p-4">
  <!-- En-tête -->
  <div class="flex justify-between items-start">
    <div>
      <p class="text-xl font-semibold">{{ medicament.nomMedicament }}</p>
      <!-- Prix ajouté ici -->
      <p class="text-primary font-bold text-lg mt-1">
        {{ medicament.prixVenteMedicament| number }} ar
      </p>
    </div>
    <div class="bg-accent border-border rounded-lg border px-2 py-1">
      <p class="text-accent-foreground">{{ medicament.formeMedicament }}</p>
    </div>
  </div>

  <!-- Dosage -->
  <p class="mt-2">
    <span class="text-muted-foreground">Dosage : </span>
    <span class="font-medium">{{ medicament.dosageMedicament }}</span>
  </p>

  <div class="pt-3"></div>

  <!-- État du stock -->
  <div>
    <div class="flex justify-between items-center">
      <p class="text-muted-foreground text-sm">État du stock</p>
      <p class="text-muted-foreground text-sm">
        {{ medicament.quantite }} {{ medicament.quantite > 1 ? "unités" : "unité" }} disponible(s)
      </p>
    </div>
    <div class="h-2 w-full rounded-full bg-gray-200 mt-1">
      <div class="h-full rounded-full" [style.width.%]="pourcentageStock" [ngClass]="couleurBarStock"></div>
    </div>
  </div>

  <div class="pt-4"></div>

  <!-- Formulaire d'ajout au panier -->
  <form (submit)="addToCart($event)">
    <div class="flex justify-between gap-4 items-end">
      <div class="flex-1">
        <label class="block text-sm text-muted-foreground mb-1">Quantité</label>
        <input
          class="w-full max-w-[150px] px-3 py-2 border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"
          type="number"
          [formControl]="quantite"
          min="1"
          [max]="medicament.quantite"
        />
        <p class="text-destructive text-sm mt-1 h-5" *ngIf="quantite.invalid && quantite.touched">
          <span *ngIf="quantite.hasError('required')">Champ requis</span>
          <span *ngIf="quantite.hasError('min')">Minimum 1 unité</span>
          <span *ngIf="quantite.hasError('max')">
            Stock insuffisant (max: {{ medicament.quantite }})
          </span>
        </p>
      </div>
      <div>
        <button
          class="button-primary text-nowrap px-4 py-2.5 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors flex items-center gap-2"
          type="submit"
          [disabled]="quantite.invalid"
        >
          <i class="fas fa-cart-plus"></i>
          Ajouter au panier
        </button>
      </div>
    </div>
  </form>
</div>